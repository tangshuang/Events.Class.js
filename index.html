<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Home</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/search.js"></script>
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.4.5/fuse.min.js"></script> -->
    <script src="scripts/fuse.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme.css">
    
    
    
<svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none">
    <defs>
        <symbol id="copy-icon" viewbox="0 0 488.3 488.3">
            <g>
                <path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/>
                <path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/>
            </g>
        </symbol>
    </defs>
</svg>

</head>
<body>
<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html"><div class="text">ETX</div></a></h2><div class="search-box"><input type="text" placeholder="Search..." id="search-box" /><div class="search-item-container" id="search-item-container"><ul class="search-item-ul" id="search-item-ul"></ul></div></div><div class="sidebar-list-div"></div>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1>ETX</h1>
<p>A js super Event Trigger manager.</p>
<h2>Install</h2>
<pre class="prettyprint source"><code>npm i etx
</code></pre>
<h2>Import</h2>
<p>ES6:</p>
<pre class="prettyprint source lang-js"><code>import Etx from 'etx'
</code></pre>
<p>CommonJS:</p>
<pre class="prettyprint source lang-js"><code>const { Etx } = require('etx')
</code></pre>
<p>AMD:</p>
<pre class="prettyprint source lang-html"><code>&lt;script src=&quot;./node_modules/etx/dist/etx.js&quot;>&lt;/script>
&lt;script>
define(function(require, exports, module) {
  const { Etx } = require('etx')
})
&lt;/script>
</code></pre>
<p>Normal Browsers:</p>
<pre class="prettyprint source lang-html"><code>&lt;script src=&quot;./node_modules/etx/dist/etx.js&quot;>&lt;/script>
&lt;script>
const { Etx } = window['etx']
&lt;/script>
</code></pre>
<h2>Usage</h2>
<pre class="prettyprint source lang-js"><code>const etx = new Etx()
etx.on('my_event', (e, ...args) => {
  //...
})
//...
etx.emit('my_event', arg1, arg2)
</code></pre>
<h2>API</h2>
<h3>on(event, callback, priority?)</h3>
<ul>
<li>event: string, event name</li>
<li>callback: function, should be bound function if needed</li>
<li>priority: number, the bigger the earlier, default 10</li>
</ul>
<pre class="prettyprint source lang-js"><code>etx.on('some_event', (e, name, age) => {
  if (name === 'dota') {
    e.stop()
  }
}, 13)

etx.emit('some_event', name, age)
</code></pre>
<p>Callback function parameters:</p>
<ul>
<li>e: a object which have some information about current event
<ul>
<li>target: event name which passed by <code>emit</code></li>
<li>event: event name which passed by <code>on</code></li>
<li>callback: event callback</li>
<li>priority: event priority</li>
<li>broadcast: is broadcasting?</li>
<li>preventDefault: function, when invoked, the left callbacks of current event will not run</li>
<li>stopPropagation: fuction, when invoked, callbacks of children's and parents' will not run, not contains roots' callbacks</li>
<li>stopImmediatePropagation: function, preventDefault + stopPropagation, and roots' callbacks will not run</li>
<li>stack: code stack, you can use it for debug</li>
</ul>
</li>
<li>...args: which passed by <code>emit</code></li>
</ul>
<p><strong>event name rules</strong></p>
<p>Use <code>.</code> to concat deep path.</p>
<pre class="prettyprint source lang-js"><code>etx.on('parent.child', fn)

etx.emit('parent', data) // fn not invoked
etx.emit('parent.child.subchild', data) // fn invoked
</code></pre>
<p>Use <code>*</code> to stand for root binding. All emits will trigger the callback of <code>*</code>, unless you call <code>stopImmediatePropagation</code> inside one of callbacks.</p>
<pre class="prettyprint source lang-js"><code>etx.on('*', fn)
</code></pre>
<h3>off(event, callback?)</h3>
<p>If you do not pass callback, all callbacks of this event will be removed.</p>
<p>Notice: you should must off etx' callbacks when you do not need them!!!</p>
<h3>once(event, callback, priority?)</h3>
<p>The same as <code>on</code>, callback will only run once, after it is executed, it will be offed.</p>
<h3>contain(event, callback?)</h3>
<p>Whether a event and callback is registered into the Etx instance.</p>
<pre class="prettyprint source lang-js"><code>if (etx.contain('parent', callback)) {
  // ...
}
</code></pre>
<h3>emit(broadcast?, event, ...args)</h3>
<p>Trigger callback functions of this event by passing arguments.
Will propagete to parents and roots.</p>
<p><code>args</code> will be received by <code>on</code> callback function.</p>
<ul>
<li>broadcast: whether to broadcast to children? default false</li>
<li>event: event name</li>
</ul>
<pre class="prettyprint source lang-js"><code>etx.on('*', (e, ...args) => {
  console.log(0)
})
etx.on('parent', (e, ...args) => {
  console.log(1)
})
etx.on('parent.child', (e, ...args) => {
  console.log(2)
})
etx.on('parent.child.sub', (e, ...args) => {
  console.log(3)
})

etx.emit('parent.child', ...args) // 2 1 0
etx.emit(true, 'parent.child', ...args) // 2 3 1 0 // broadcast to children before propagate to parents
</code></pre>
<h3>dispatch(broadcast?, event, ...args)</h3>
<p>Like <code>emit</code>, but use <em>async</em> callback functions and return a promise:</p>
<pre class="prettyprint source lang-js"><code>etx.on('evt', async function f1() {})
etx.on('evt', async function f2() {})
etx.on('evt', async function f3() {})

await etx.dispatch('evt').then(() => { // f1, f2, f3 will run one by one (in series)
  // ...
})
</code></pre>
<p>For this code block, f2 will run after f1 resolved, f3 is the same will run after f2 resolved. If f1 rejected, f2 and f3 will not run any more.</p>
<p>Notice: callback function can be or not be async function.</p>
<h3>distribute(broadcast?, event, ...args)</h3>
<p>Like <code>dispatch</code> but parallel in each level.</p>
<pre class="prettyprint source lang-js"><code>etx.on('evt', async function f1() {})
etx.on('evt', async function f2() {})
etx.on('evt', async function f3() {})

await etx.distribute('evt').then(() => { // f1, f2, f3 will run at the same time (in parallel)
  // ...
})
</code></pre>
<p>Each level (current, propagation, root) callbacks will run in parallel.
Only after all callbacks resolved, the callback in then will run.
If one of callbacks rejected, it not affect others, but the whole process will be rejected finally.</p>
<p>Notice: callback function can be or not be async function.</p>
<h3>silent(fn|bool|array)</h3>
<p>Disable trigger callbacks in <code>fn</code>.</p>
<pre class="prettyprint source lang-js"><code>etx.silent(() => {
  etx.emit('some') // will not trigger any callbacks
})
</code></pre>
<p>Or you can pass a boolean to switch silent mode.</p>
<pre class="prettyprint source lang-js"><code>etx.silent(true)
etx.emit('some')
etx.silent(false)
</code></pre>
<p>Or an array which contains events which want to disable.</p>
<pre class="prettyprint source lang-js"><code>etx.silent(['some', 'one'])
etx.emit('some')
etx.emit('one')
etx.silent(false)
</code></pre>
<p>The events in passed array should extract match the emit event names.</p>
<h3>scope(fn|is)</h3>
<p>Only trigger self's callbacks in <code>fn</code>, never propagate.</p>
<pre class="prettyprint source lang-js"><code>etx.secret(() => {
  etx.emit('parent.child') // parents and roots will not be triggered
})
</code></pre>
<h3>destroy()</h3>
<p>Destory the instance.</p></article>
    </section>






</div>

<br class="clear">

<footer>
  
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script>
var list = [];
setupSearch(list)
</script>

 
<script type="text/javascript" src="scripts/misc.js"></script>
</body>
</html>